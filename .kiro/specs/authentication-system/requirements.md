# Requirements Document

## Introduction

이 문서는 포트폴리오 웹사이트에 Supabase를 활용한 사용자 인증 및 회원 관리 시스템을 구현하기 위한 요구사항을 정의합니다. 현재 정적으로 구현된 블로그 댓글 시스템을 Supabase 데이터베이스와 인증 시스템을 통해 동적으로 변경하고, 사용자가 로그인하여 댓글을 작성하고 관리할 수 있는 기능을 제공합니다.

## Requirements

### Requirement 1

**User Story:** 방문자로서, Supabase Auth를 통해 이메일과 비밀번호로 회원가입을 할 수 있어야 하므로, 개인화된 서비스를 이용할 수 있다.

#### Acceptance Criteria

1. WHEN 사용자가 회원가입 페이지에 접근 THEN 시스템은 이메일, 비밀번호, 비밀번호 확인, 닉네임 입력 필드를 제공해야 한다
2. WHEN 사용자가 유효한 정보로 회원가입을 시도 THEN Supabase Auth는 계정을 생성하고 이메일 확인 링크를 발송해야 한다
3. WHEN 사용자가 이메일 확인 링크를 클릭 THEN 시스템은 계정을 활성화하고 로그인 페이지로 리디렉션해야 한다
4. WHEN 사용자가 이미 존재하는 이메일로 회원가입을 시도 THEN Supabase는 "이미 존재하는 이메일입니다" 오류를 반환하고 시스템은 이를 표시해야 한다
5. WHEN 사용자가 비밀번호와 비밀번호 확인이 일치하지 않을 때 THEN 시스템은 "비밀번호가 일치하지 않습니다" 오류 메시지를 표시해야 한다
6. WHEN 사용자가 6자 미만의 비밀번호를 입력 THEN 시스템은 "비밀번호는 최소 6자 이상이어야 합니다" 오류 메시지를 표시해야 한다

### Requirement 2

**User Story:** 등록된 사용자로서, Supabase Auth를 통해 이메일과 비밀번호로 로그인할 수 있어야 하므로, 개인화된 기능을 사용할 수 있다.

#### Acceptance Criteria

1. WHEN 사용자가 로그인 페이지에 접근 THEN 시스템은 이메일과 비밀번호 입력 필드를 제공해야 한다
2. WHEN 사용자가 올바른 자격 증명으로 로그인 THEN Supabase Auth는 세션을 생성하고 시스템은 사용자를 메인 페이지로 리디렉션해야 한다
3. WHEN 사용자가 잘못된 자격 증명으로 로그인 시도 THEN Supabase는 인증 오류를 반환하고 시스템은 "이메일 또는 비밀번호가 올바르지 않습니다" 메시지를 표시해야 한다
4. WHEN 로그인된 사용자가 브라우저를 새로고침 THEN Supabase 세션이 유효한 경우 시스템은 로그인 상태를 유지해야 한다
5. WHEN 사용자가 로그아웃 버튼을 클릭 THEN Supabase Auth는 세션을 종료하고 시스템은 로그인 페이지로 리디렉션해야 한다

### Requirement 3

**User Story:** 사용자로서, Supabase를 통해 이메일 인증을 받을 수 있어야 하므로, 계정의 보안성을 확보할 수 있다.

#### Acceptance Criteria

1. WHEN 사용자가 회원가입을 완료 THEN Supabase Auth는 자동으로 이메일 확인 링크를 발송해야 한다
2. WHEN 사용자가 이메일 확인 링크를 클릭 THEN Supabase는 계정을 활성화하고 시스템은 "이메일 인증이 완료되었습니다" 메시지를 표시해야 한다
3. WHEN 이메일 인증이 완료되지 않은 사용자가 로그인 시도 THEN 시스템은 "이메일 인증을 완료해주세요" 메시지와 함께 재발송 버튼을 제공해야 한다
4. WHEN 사용자가 이메일 재발송 버튼을 클릭 THEN Supabase는 새로운 확인 이메일을 발송하고 시스템은 "확인 이메일을 재발송했습니다" 메시지를 표시해야 한다
5. WHEN 이메일 확인 링크가 만료 THEN 시스템은 "링크가 만료되었습니다. 새로운 링크를 요청해주세요" 메시지를 표시해야 한다

### Requirement 4

**User Story:** 사용자로서, Supabase를 통해 비밀번호를 재설정할 수 있어야 하므로, 비밀번호를 잊어버려도 계정에 다시 접근할 수 있다.

#### Acceptance Criteria

1. WHEN 사용자가 로그인 페이지에서 "비밀번호 찾기" 링크를 클릭 THEN 시스템은 비밀번호 재설정 페이지로 이동해야 한다
2. WHEN 사용자가 등록된 이메일을 입력하고 재설정 요청 THEN Supabase Auth는 비밀번호 재설정 링크를 이메일로 발송해야 한다
3. WHEN 사용자가 비밀번호 재설정 링크를 클릭 THEN 시스템은 새 비밀번호 입력 페이지로 이동해야 한다
4. WHEN 사용자가 새 비밀번호를 입력하고 저장 THEN Supabase는 비밀번호를 업데이트하고 시스템은 "비밀번호가 성공적으로 변경되었습니다" 메시지를 표시해야 한다
5. WHEN 등록되지 않은 이메일로 재설정 요청 THEN 시스템은 "해당 이메일로 등록된 계정이 없습니다" 메시지를 표시해야 한다

### Requirement 5

**User Story:** 방문자로서, Discord 계정을 통해 간편하게 로그인할 수 있어야 하므로, 별도의 회원가입 없이 서비스를 이용할 수 있다.

#### Acceptance Criteria

1. WHEN 사용자가 로그인 페이지에 접근 THEN 시스템은 "Discord로 로그인" 버튼을 제공해야 한다
2. WHEN 사용자가 Discord 로그인 버튼을 클릭 THEN 시스템은 Discord OAuth 인증 페이지로 리디렉션해야 한다
3. WHEN 사용자가 Discord에서 인증을 완료 THEN Supabase Auth는 Discord 계정 정보를 받아 세션을 생성해야 한다
4. WHEN Discord 로그인이 성공 THEN 시스템은 Discord 사용자 정보(username, avatar)를 users 테이블에 저장해야 한다
5. WHEN Discord 로그인 중 오류 발생 THEN 시스템은 "Discord 로그인 중 오류가 발생했습니다" 메시지를 표시해야 한다

### Requirement 6

**User Story:** 로그인된 사용자로서, 블로그 포스트에 댓글을 작성할 수 있어야 하므로, 다른 사용자들과 소통할 수 있다.

#### Acceptance Criteria

1. WHEN 로그인된 사용자가 블로그 포스트를 조회 THEN 시스템은 댓글 작성 폼을 표시해야 한다
2. WHEN 로그인되지 않은 사용자가 블로그 포스트를 조회 THEN 시스템은 "로그인 후 댓글을 작성할 수 있습니다" 메시지를 표시해야 한다
3. WHEN 로그인된 사용자가 댓글을 작성하고 제출 THEN 시스템은 댓글을 저장하고 댓글 목록에 즉시 표시해야 한다
4. WHEN 댓글이 성공적으로 작성 THEN 시스템은 댓글 작성 폼을 초기화해야 한다
5. WHEN 사용자가 빈 내용으로 댓글 제출 시도 THEN 시스템은 "댓글 내용을 입력해주세요" 오류 메시지를 표시해야 한다

### Requirement 7

**User Story:** 로그인된 사용자로서, 내가 작성한 댓글을 수정하고 삭제할 수 있어야 하므로, 댓글을 관리할 수 있다.

#### Acceptance Criteria

1. WHEN 로그인된 사용자가 자신의 댓글을 조회 THEN 시스템은 수정 및 삭제 버튼을 표시해야 한다
2. WHEN 로그인된 사용자가 다른 사용자의 댓글을 조회 THEN 시스템은 수정 및 삭제 버튼을 표시하지 않아야 한다
3. WHEN 사용자가 댓글 수정 버튼을 클릭 THEN 시스템은 댓글 내용을 편집 가능한 폼으로 변경해야 한다
4. WHEN 사용자가 댓글을 수정하고 저장 THEN 시스템은 변경사항을 저장하고 수정된 댓글을 표시해야 한다
5. WHEN 사용자가 댓글 삭제 버튼을 클릭 THEN 시스템은 확인 대화상자를 표시하고 확인 시 댓글을 삭제해야 한다

### Requirement 8

**User Story:** 사용자로서, 네비게이션 바에서 로그인 상태를 확인할 수 있어야 하므로, 현재 상태를 쉽게 파악할 수 있다.

#### Acceptance Criteria

1. WHEN 로그인되지 않은 사용자가 사이트를 방문 THEN 네비게이션 바에 "로그인" 및 "회원가입" 링크가 표시되어야 한다
2. WHEN 로그인된 사용자가 사이트를 방문 THEN 네비게이션 바에 사용자 닉네임과 "로그아웃" 버튼이 표시되어야 한다
3. WHEN 로그인된 사용자가 사용자 메뉴를 클릭 THEN 시스템은 프로필 보기, 설정, 로그아웃 옵션을 포함한 드롭다운 메뉴를 표시해야 한다
4. WHEN 사용자가 로그인 링크를 클릭 THEN 시스템은 로그인 페이지로 이동해야 한다
5. WHEN 사용자가 회원가입 링크를 클릭 THEN 시스템은 회원가입 페이지로 이동해야 한다

### Requirement 9

**User Story:** 로그인된 사용자로서, 내 프로필 정보를 조회하고 수정할 수 있어야 하므로, 개인 정보를 관리할 수 있다.

#### Acceptance Criteria

1. WHEN 로그인된 사용자가 프로필 페이지에 접근 THEN 시스템은 현재 닉네임, 이메일, 가입일을 표시해야 한다
2. WHEN 사용자가 프로필 수정 버튼을 클릭 THEN 시스템은 닉네임 수정 폼을 표시해야 한다
3. WHEN 사용자가 닉네임을 수정하고 저장 THEN 시스템은 변경사항을 저장하고 성공 메시지를 표시해야 한다
4. WHEN 사용자가 이미 사용 중인 닉네임으로 변경 시도 THEN 시스템은 "이미 사용 중인 닉네임입니다" 오류 메시지를 표시해야 한다
5. WHEN 사용자가 비밀번호 변경을 요청 THEN 시스템은 현재 비밀번호, 새 비밀번호, 새 비밀번호 확인 필드를 제공해야 한다

### Requirement 10

**User Story:** 시스템 관리자로서, 기존 Supabase 데이터베이스 구조와 통합된 사용자 시스템이 필요하므로, posts와 comments 테이블과 연동되는 인증을 구현할 수 있다.

#### Acceptance Criteria

1. WHEN 사용자가 회원가입을 완료 THEN 시스템은 Supabase Auth 사용자와 연동된 users 테이블 레코드를 생성해야 한다
2. WHEN 로그인된 사용자가 댓글을 작성 THEN 시스템은 comments 테이블의 author_id 필드에 사용자 ID를 저장해야 한다
3. WHEN 댓글을 조회 THEN 시스템은 users 테이블과 조인하여 작성자 정보(username, display_name)를 함께 반환해야 한다
4. WHEN 사용자 프로필이 업데이트 THEN 시스템은 users 테이블의 last_synced 필드를 현재 시간으로 업데이트해야 한다
5. WHEN posts 테이블에 새 글이 작성 THEN 시스템은 author_id 필드에 현재 로그인된 사용자 ID를 저장해야 한다

### Requirement 11

**User Story:** 시스템 관리자로서, 사용자 데이터가 안전하게 저장되고 관리되어야 하므로, 보안과 개인정보를 보호할 수 있다.

#### Acceptance Criteria

1. WHEN 사용자가 비밀번호를 입력 THEN Supabase Auth는 비밀번호를 안전하게 해시화하여 저장해야 한다
2. WHEN 사용자 세션이 생성 THEN Supabase는 JWT 토큰을 생성하고 적절한 만료 시간을 설정해야 한다
3. WHEN 민감한 사용자 정보에 접근 THEN 시스템은 HTTPS를 통해서만 전송해야 한다
4. WHEN 사용자 데이터를 저장 THEN 시스템은 개인정보보호법에 따라 최소한의 필요한 정보만 수집해야 한다
5. WHEN 데이터베이스에 접근 THEN 시스템은 Row Level Security(RLS) 정책을 통해 사용자별 데이터 접근을 제한해야 한다

### Requirement 12

**User Story:** 사용자로서, 모바일 기기에서도 인증 기능을 원활하게 사용할 수 있어야 하므로, 어떤 기기에서든 접근할 수 있다.

#### Acceptance Criteria

1. WHEN 모바일 사용자가 로그인 페이지에 접근 THEN 시스템은 터치 친화적인 인터페이스를 제공해야 한다
2. WHEN 모바일 사용자가 회원가입 폼을 작성 THEN 시스템은 적절한 키보드 타입을 표시해야 한다 (이메일 필드에는 이메일 키보드)
3. WHEN 모바일 사용자가 댓글을 작성 THEN 시스템은 충분한 터치 영역과 가독성을 제공해야 한다
4. WHEN 모바일 사용자가 사용자 메뉴를 사용 THEN 시스템은 터치에 최적화된 드롭다운 메뉴를 제공해야 한다
5. WHEN 모바일에서 폼 유효성 검사 오류 발생 THEN 시스템은 명확하고 읽기 쉬운 오류 메시지를 표시해야 한다
